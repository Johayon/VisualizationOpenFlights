<!doctype html>
<meta charset="utf-8">

<link href="http://www.d3plus.org/css/d3plus.css" rel="stylesheet" />
<script src="http://www.d3plus.org/js/d3.js"></script>
<script src="http://www.d3plus.org/js/d3plus.js"></script>
 
<div id="viz"></div>
 
<script>

var Range = 800;

d3.csv("NodeForGraphVisualization.csv",function(lines) {
    var numberOfLines = lines.length;
    var nodesData = [];
    for (var i = 0; i< numberOfLines;i++)
    {   
        // Recuperation des noeuds
        var airportID = lines[i]['IATA/FAA']
        var airportSize = lines[i].TotalFlight
        var airportAirlines = lines[i].Airlines
        var airportName = lines[i].Name
        var airportCity = lines[i].City
        var airportCountry = lines[i].Country
        if (airportSize > Range){
            nodesData.push({"name": airportID, "Complete Name" : airportName , "City, Country" : airportCity + ", " +  airportCountry  ,"size": parseInt(airportSize) })
        }
    }





d3.csv("LinkForGraphVisualization.csv", function(lines)
{  
    var numberOfLines = lines.length;
    var connectionsData = [];
    for (var i = 0; i < numberOfLines; i++) 
    {
        // Récupération des données brutes 
        var airportID = lines[i]['IATA/FAA_x'];
        var airport2ID = lines[i]['IATA/FAA_y'];
        var airportSize = lines[i]['TotalFlight_x']
        var airport2Size = lines[i]['TotalFlight_y']
        var nbOperators = lines[i]['size'];
        console.log(parseInt(nbOperators))
        // Cas ou la ligne ne décrit qu'un seul marchand 
        // Sinon c'est que c'est une connexion 
        if (airportSize > Range && airport2Size > Range){
            connectionsData.push( {"source": airportID, "target": airport2ID, "strength":parseInt(nbOperators)} )
        }
    }
    var visualization = d3plus.viz()
    .container("#viz")
    .type("network")
    .data(nodesData)
    .edges({"label": "strength", "size": "strength", "large": 1000, "value": connectionsData})
    .size("size")
    .tooltip(["Complete Name","City, Country"])
    .id("name")
    .draw()

    console.log("Node_Data: ", nodesData);
    console.log("connectionsData: ", connectionsData);

})})

</script>
